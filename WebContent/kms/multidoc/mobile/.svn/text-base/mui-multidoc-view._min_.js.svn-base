require({cache:{"sys/tag/mobile/import/js/select/DialogCategory":function(){define(["dojo/_base/declare","dojo/_base/array","dojo/topic","dojo/on","dojo/touch","dojo/dom-construct","dojo/dom-class","dojo/query","mui/form/_FormBase","./_DialogCategoryBase","dojo/_base/lang","dojo/dom-style","mui/i18n/_i18n!sys/mobile/js/mui/mui-common","dojo/dom-attr","./tagUtil","mui/util"],function(e,j,g,k,d,c,o,n,m,q,a,h,b,l,i,f){var p=e("mui.tag.DialogCategory",[m,q],{idField:null,nameField:null,placeholder:null,isCreateField:true,opt:true,required:"",EVENT_VALUE_CHANGE:"/mui/Category/valueChange",EVENT_ADD_VALUE:"/mui/tag/addValue",postMixInProperties:function(){this.inherited(arguments);if(this.nameField){var r=n("[name='"+this.nameField+"']");if(r.length>0){this.isCreateField=false;this.opt=false}}else{if(!this.idDom){this.isCreateField=false;this.opt=false}}},buildRendering:function(){this.inherited(arguments);var r=this;if(this.edit){this.connect(this.domNode,"click",function(){r.defer(function(){r._selectCate()},350)})}this._buildValue();this.subscribe(this.EVENT_ADD_VALUE,"addValue")},postCreate:function(){this.inherited(arguments);this.eventBind()},startup:function(){this.inherited(arguments);this.key=this.idField;this.set("value",this.curIds)},_buildValue:function(){if(this.edit){this.setInputValue()}if(!this.cateFieldShow){this.cateFieldShow=c.create("div",{className:"muiCateFiledShow",placeholder:b["mui.form.please.input"]+" "+this.subject},this.isCreateField?this.valueNode:this.nameDom.parentNode)}else{if(a.isString(this.cateFieldShow)){this.cateFieldShow=n(this.cateFieldShow)[0]}}if(this.cateFieldShow&&this.edit&&!this.cateFieldShow.getAttribute("data-del-listener-"+this.id)){this.connect(this.cateFieldShow,k.selector(".muiAddressOrg","click"),function(r){if(r.stopPropagation){r.stopPropagation()}if(r.cancelBubble){r.cancelBubble=true}if(r.preventDefault){r.preventDefault()}if(r.returnValue){r.returnValue=false}var s=n(r.target).closest(".muiAddressOrg");s.forEach(function(t){var u=t.getAttribute("data-id");this.defer(function(){this._delOneOrg(t,u)},420)},this)})}c.empty(this.cateFieldShow);this.buildValue(this.cateFieldShow)},setInputValue:function(){if(this.idField&&!this.idDom){var t=n("[name='"+this.idField+"']");if(t.length>0){this.idDom=t[0]}else{this.idDom=c.create("input",{type:"hidden",name:this.idField},this.valueNode)}}if(this.nameField&&!this.nameDom){var t=n("[name='"+this.nameField+"']");if(t.length>0){this.nameDom=t[0]}else{this.nameDom=c.create("input",{type:"hidden",name:this.nameField},this.valueNode)}}if(!this.idField&&!this.idDom&&!this.nameField&&!this.nameDom){var u=this.domNode;while(u!=null&&u.tagName!="TD"){u=u.parentNode}if(u!=null){var r=u.getElementsByTagName("INPUT");for(var s=0;s<r.length;s++){if(r[s].type=="hidden"){this.idDom=r[s]}else{if(this.nameDom==null){this.nameDom=r[s]}}}if(this.idDom==null){this.idDom=r[1]}}}if(this.idDom){if(!this.idField){this.idField=this.idDom.name}this.idDom.value=this.curIds==null?"":this.curIds}if(this.nameDom){if(!this.nameField){this.nameField=this.nameDom.name}this.nameDom.value=this.curNames==null?"":this.curNames}this.set("value",this.curIds)},buildValue:function(r){if(this[this.primaryKey]!=null&&this[this.primaryKey]!=""){var t=this.curIds.split(this.splitStr);var u=this.curNames.split(this.splitStr);for(var s=0;s<u.length;s++){this._buildOneOrg(r,t[s],u[s]);if(s<t.length-1&&!this.edit){c.create("span",{innerHTML:this.splitStr},r)}}}else{if(this.edit&&this.placeholder!=null&&this.placeholder!=""){c.create("div",{className:"muiCatePlaceHold",innerHTML:this.placeholder},r)}}},addValue:function(y,w,s){if(w[this.primaryKey]!=null&&w[this.primaryKey]!=""){if(!s){if(a.isString(this.cateFieldShow)){this.cateFieldShow=n(this.cateFieldShow)[0]}s=this.cateFieldShow}if(!this.isMul){if(this.curIds&&this.curIds.split(this.splitStr).length>0){var r=this.curIds.split(this.splitStr);for(var t=0;t<r.length;t++){var v=n("[data-id='"+r[t]+"']")[0];if(v){this._delOneOrg(v,r[t])}}this.curIds="";this.curNames=""}w.curIds=w.curIds.split(this.splitStr)[0];w.curNames=w.curNames.split(this.splitStr)[0]}var u=w.curIds?w.curIds.split(this.splitStr):[];var x=w.curNames.split(this.splitStr);for(var t=x.length-1;t>=0;t--){this.buildOneInpOrg(s,u[t],x[t],"first");if(t<u.length-1&&!this.edit){c.create("span",{innerHTML:this.splitStr},s)}}if(u){if(this.curIds){this.curIds=u.join(";")+";"+this.curIds}else{this.curIds=u.join(";")}}if(x){if(this.curNames){this.curNames=x.join(";")+";"+this.curNames}else{this.curNames=x.join(";")}}this.setInputValue();if(this.validation){this.validation.hideWarnHint(this.domNode)}}},buildOneInpOrg:function(t,w,u,s){w=w?w:"";u=u?u:"";s=s?s:"last";var v=c.create("div",{className:"muiAddressOrg","data-id":w},t,s);c.create("div",{className:"name",innerHTML:f.formatText(u)},v);if(this.edit){var r=c.create("div",{className:"del fontmuis muis-epid-close"},v);this.connect(r,"click",function(){this._delOneOrg(v,w)})}},_buildOneOrg:function(s,v,t,r){v=v?v:i.GenerateId();t=t?t:"";r=r?r:"last";var u=c.create("div",{className:"muiAddressOrg","data-id":v},s,r);c.create("div",{className:"name",innerHTML:f.formatText(t)},u);if(this.edit){c.create("div",{className:"del fontmuis muis-epid-close"},u)}},_delOneOrg:function(t,v){var s=this.curIds.split(this.splitStr);var u=this.curNames.split(this.splitStr);var r=j.indexOf(s,v);if(r>-1){s.splice(r,1);u.splice(r,1);this.curIds=s.join(this.splitStr);this.curNames=u.join(this.splitStr);if(this.idDom){this.idDom.value=this.curIds==null?"":this.curIds;this.set("value",this.curIds==null?"":this.curIds)}if(this.nameDom){this.nameDom.value=this.curNames==null?"":this.curNames}if(this.curIds==null||this.curIds==""){this.buildValue(this.cateFieldShow)}g.publish(this.EVENT_VALUE_CHANGE,this,{curIds:this.curIds,curNames:this.curNames})}c.destroy(t)},returnDialog:function(s,r){this.inherited(arguments);if(s.key==this.idField){this.set("value",this.curIds);this._buildValue();g.publish(this.EVENT_VALUE_CHANGE,this,{curIds:this.curIds,curNames:this.curNames})}},clearDialog:function(s,r){this.inherited(arguments);if(s.key==this.idField){this.set("value",this.curIds);this._buildValue();g.publish(this.EVENT_VALUE_CHANGE,this,{curIds:this.curIds,curNames:this.curNames})}}});return p})},"sys/tag/mobile/import/js/SysTag":function(){define(["dojo/_base/declare","dojo/dom-construct","dijit/_WidgetBase","mui/util","mui/device/adapter"],function(d,c,e,b,a){return d("sys.tag.SysTag",[e],{tag:"",modelName:"",tags:[],baseClass:"muiTagContainer",url:"/sys/ftsearch/mobile/index.jsp?keyword=!{keyword}&modelName=!{modelName}&searchFields=tag",buildRendering:function(){this.inherited(arguments);if(this.tag){var f=this.tag;this.tags=f.split(";");if(this.tags&&this.tags.length>0){for(var h=0;h<this.tags.length;h++){var g=c.create("span",{className:"muiTag","data-index":h,innerHTML:b.formatText(this.tags[h])},this.domNode)}}}},startup:function(){this.inherited(arguments);this.connect(this.domNode,"onclick","tagClick")},tagClick:function(f){var i=f.target,h=f.target.getAttribute("data-index");if(h!==null&&typeof(h)!=="undefined"&&h>=0){var g=b.urlResolver(this.url,{keyword:encodeURIComponent(this.tags[h]),modelName:this.modelName||""});a.open(b.formatUrl(g),"_blank")}}})})},"sys/tag/mobile/import/js/select/_CategoryBase":function(){define(["dojo/_base/declare","dojo/topic","dojo/dom","dojo/dom-construct","dojo/dom-style","dojo/dom-class","dojo/_base/lang","dojo/html","dojo/_base/array","mui/util","dojo/touch","mui/device/adapter","mui/history/listener"],function(g,j,e,d,k,n,a,i,l,h,f,m,b){var c=g("mui.form._CategoryBase",null,{key:null,type:null,curIds:"",curNames:"",splitStr:";",confirm:false,isMul:false,templURL:null,jsURL:null,_cateDialogPrefix:"__cate_dialog_",afterSelect:null,authType:"02",eventBind:function(){this.subscribe("/mui/category/submit",a.hitch(this,"returnDialog"));this.subscribe("/mui/category/cancel",a.hitch(this,"closeDialog"));this.subscribe("/mui/category/clear",a.hitch(this,"clearDialog"));this.subscribe("/mui/category/changeprops",a.hitch(this,"doChangeProps"))},doChangeProps:function(p){for(var o in p){this[o]=p[o]}},returnDialog:function(p,o){if(o){if(p.key==this.key){this.curIds=o.curIds;this.curNames=o.curNames;this.closeDialog(p);if(this.afterSelect){this.afterSelect(o)}}}},__doCloseDialog:function(){if(this.previousTitle){m.setTitle(this.previousTitle);this.previousTitle=null}if(this.beforeSelectCateHistoryId){b.goNoop({historyId:this.beforeSelectCateHistoryId});this.beforeSelectCateHistoryId=null}n.add(this.dialogDiv,"fadeOut animated");this.defer(function(){if(this.dialogContainerDiv){k.set(this.dialogContainerDiv,"display","none")}if(this.dialogDiv){k.set(this.dialogDiv,"display","none")}},500);setTimeout(a.hitch(this,function(){if(this.parseResults&&this.parseResults.length){l.forEach(this.parseResults,function(o){if(o.destroy){o.destroy()}});delete this.parseResults}d.destroy(this.dialogDiv);this.dialogDiv=null;this._working=false}),410)},_closeDialog:function(o){var p=o.target;if(this.dialogDiv&&p===this.dialogDiv){this.__doCloseDialog()}},closeDialog:function(o){if(this.dialogDiv&&o.key==this.key){this.__doCloseDialog()}},clearDialog:function(o){if(o.key==this.key){this.curIds="";this.curNames="";this.closeDialog(o)}},showAnimate:function(){k.set(this.dialogContainerDiv,"display","block");k.set(this.dialogDiv,"display","block");n.add(this.dialogDiv,"fadeIn animated");k.set(this.dialogDiv,"background-color","rgba(0, 0, 0, 0.6)");this.defer(function(){k.set(this.dialogDiv,{opacity:1});n.remove(this.dialogDiv,"fadeIn")},500)},urlResolver:function(o){if(o&&!this._working){this._working=true;this.dialogDiv=e.byId(this._cateDialogPrefix+this.key);if(this.dialogDiv==null){var p=h.urlResolver(o,this);if(p.startsWith("/")&&!p.startsWith(dojoConfig.baseUrl)){p=h.formatUrl(p)}return p}}return false},_selectCate$1:function(){var q;if(this.templURL){q=this.urlResolver(this.templURL);if(!q){return}q="dojo/text!"+q}else{if(this.jsURL){q=this.urlResolver(this.jsURL);if(!q){return}}}var o=this;var p=this._cateDialogPrefix+this.key;require([q],function(s){o.dialogDiv=d.create("div",{id:p,className:"muiCateDiaglogN",tabindex:"0"},document.body,"last");o.dialogContainerDiv=d.create("div",{className:"muiCateDiaglogContainer "},o.dialogDiv);o.dialogDiv.focus();o.defer(function(){o.connect(o.dialogDiv,"click","_closeDialog")},500);h.disableTouch(o.dialogDiv,f.move);var r=new i._ContentSetter({node:o.dialogContainerDiv,parseContent:true,cleanContent:true,onBegin:function(){this.content=a.replace(this.content,{categroy:o});this.inherited("onBegin",arguments)}});r.set(s);r.parseDeferred.then(function(t){o.parseResults=t;j.publish("/mui/category/tmploaded",{dom:o.dialogDiv,widgetList:t})});r.tearDown();o.showAnimate()})},_selectCate:function(){var q=a.hitch(this,function(){this._selectCate$1();this.previousTitle=document.title;if(this.subject){m.setTitle(this.subject)}});var p=a.hitch(this,function(){this.beforeSelectCateHistoryId=null;this.__doCloseDialog()});var o=b.push({forwardCallback:q,backCallback:p});this.beforeSelectCateHistoryId=o.previousId}});return c})},"sys/tag/mobile/import/js/select/DialogSelCategory":function(){define(["dojo/_base/declare","mui/form/Select","dojo/dom-construct","dojo/_base/lang","dojo/topic","dojo/_base/array","./CategoryDialog","mui/util","dojo/dom-class","mui/i18n/_i18n!sys/mobile/js/mui/mui-common"],function(f,a,e,b,g,i,k,h,j,c){var d=f("mui.tag.DialogSelCategory",[a],{store:[],name:"category",mul:false,renderListItem:function(l){var m=this.value.split(";");i.forEach(this.values,b.hitch(this,function(p,n){p.selected=false;i.forEach(m,function(q){if(String(q)==String(p.value)){p.selected=true;return}});var o=this.createListItem(p);l.appendChild(o)}))},createListItem:function(n){var l=this.itemRenderer;var p=(typeof(n.text)!="undefined"&&n.text!=null)?h.formatText(n.text.toString().replace("'","&#039;")):"";var m=(typeof(n.value)!="undefined"&&n.value!=null)?h.formatText(n.value.toString()):"";l=l.replace("!{text}",p);l=l.replace("!{checked}",n.selected);l=l.replace("!{value}",m);l=l.replace("!{mul}",this.mul);l=l.replace("!{valueField}",this.valueField);l=l.replace("!{pop}",this.pop);var o=e.toDom(l);return o},_onClick:function(l){if(this.dialog){return}this.contentNode=e.create("div",{className:"muiCheckBoxPopWarp"});var n=e.create("ul",{className:"muiRadioGroupPopList"},this.contentNode);this.renderListItem(n);var m=[];if(this.mul){m=[{title:c["mui.button.clear"],fn:b.hitch(this,this._clearClick)},{title:""},{title:c["mui.button.ok"],fn:b.hitch(this,this._DoneClick)}]}this.dialog=k.element({canClose:false,element:this.contentNode,buttons:m,position:"bottom",scrollable:false,parseable:true,showClass:"muiFormSelect",callback:b.hitch(this,function(){g.publish(this.SELECT_CALLBACK,this);this.dialog=null}),onDrawed:b.hitch(this,function(o){this.resizeTop(o);if(this.mul){this.value_s=[];var p=this.value.split(";");for(var q=0;q<p.length;q++){if(p[q]!=""){this.value_s.push(p[q])}}}})})}});return d})},"sys/tag/mobile/import/js/SysTagPda":function(){define(["dojo/_base/declare","dojo/dom-construct","dijit/_WidgetBase","mui/util","mui/device/adapter","mui/createUtils","dojo/parser","dojo/dom","mui/i18n/_i18n!sys/mobile/js/mui/mui-common","mui/i18n/_i18n!kms/multidoc/mobile/mui-multidoc-view","dojo/_base/lang","dojo/dom-style","dojo/dom-class","dijit/registry","dojo/topic","dojo/query","sys/tag/mobile/import/js/select/tagUtil"],function(o,f,h,a,k,e,b,n,j,p,r,l,i,g,m,d,c){var q=e.createTemplate;return o("sys.tag.SysTagPda",[h],{modelName:"",modelId:"",queryCondition:"",fdKey:"",curIds:"",curNames:"",required:false,isMul:true,isClick:false,baseClass:"muiTagPdaContainer muiFormEleWrap",TAG_EVENT_ADD_VALUE:"/mui/tag/addValue",url:"",buildRendering:function(){this.inherited(arguments);this.buildTagContent();this.buildSelectBtn();if(this.inputHidden!="false"){this.buildTagEditButton()}this.buildFormSubmitEvent()},buildFormSubmitEvent:function(){var s=Com_Parameter.event.submit;s[s.length]=r.hitch(this,"setQueryCondition")},setQueryCondition:function(){if(this.queryCondition){var x=this.queryCondition.split(";");var t=[];for(var v=0;v<x.length;v++){var u=x[v];var s="[name='"+u+"']";var w=d(s)[0];if(u=="docCategoryId"&&(!w||!w.value)){w=d("[name='cateId']")[0]}if(w&&w.value){t.push(w.value)}}if(t.length>0){d("[name='sysTagMainForm.fdQueryCondition']")[0].value=t.join(";")}}return true},buildTagContent:function(){var t="muiCateFiledShow muiFormItem muiTagEditContent";var s="";if(this.contentAlign=="left"){t+=" muiCateFiledShowLeft";s="text-align: left;"}this.tagBoxNode=f.create("div",{style:s,className:t},this.domNode);this.tagContentNode=f.create("div",{className:"muiTagInputContent"},this.tagBoxNode);this.tagInputBox=f.create("div",{id:this.getNodeIdStr("muiTagInputBox"),className:"muiTagInputBox"},this.tagContentNode);this.tagBtnBox=f.create("div",{className:"muiTagBtnBox"},this.tagContentNode)},buildTagEditButton:function(){this.tagEditBtn=f.create("span",{className:"fontmuis muis-org-signature muiTagBtn muiTagEditBtn"},this.tagBtnBox);this.connect(this.tagEditBtn,"click",r.hitch(this,function(){if(this.isClick){return}this.isClick=true;this.clearClick();this.getTagInputElement();l.set(this.selectBtn,"display","none");l.set(this.tagContentNode,"width","100%");i.add(this.tagContentNode,"muiTagInputEditing");this.buildTagSubmitButton();this.buildTagCancelButton();this.tagEditBtn.remove()}))},clearClick:function(){this.defer(function(){this.isClick=false},350)},buildTagSubmitButton:function(){this.tagSubmitBtn=f.create("span",{className:"muiTagBtn muiTagSubmitBtn",innerHTML:j["mui.button.ok"]},this.tagBtnBox);this.connect(this.tagSubmitBtn,"click",r.hitch(this,function(){if(this.isClick){return}this.isClick=true;this.clearClick();var w=this.tagInputNode.value;if(!w&&this.tagInputNode.inputNode){w=this.tagInputNode.inputNode.value}if(w){var x=g.byId(this.getNodeIdStr("tag_SelectDialog"));w=w.split(/;|；/);var v=x.splitStr;var s=[];var t=[];for(var u=0;u<w.length;u++){if(w[u]){s.push(w[u]);t.push(c.GenerateId())}}m.publish(this.TAG_EVENT_ADD_VALUE,this,{curNames:s.join(v),curIds:t.join(v)})}this.resetButton()}))},buildTagCancelButton:function(){this.tagCancelBtn=f.create("span",{className:"fontmuis muis-delete-document muiTagCancelBtn"},this.tagBtnBox);this.connect(this.tagCancelBtn,"click",r.hitch(this,function(){if(this.isClick){return}this.isClick=true;this.clearClick();this.resetButton()}))},resetButton:function(){l.set(this.selectBtn,"display","block");l.set(this.tagContentNode,"width","calc(100% - 3rem)");i.remove(this.tagContentNode,"muiTagInputEditing");this.buildTagEditButton();this.tagSubmitBtn.remove();this.tagCancelBtn.remove();this.tagInputDivBox.remove()},getTagInputElement:function(){var u=this.getNodeIdStr("tag_TagAddInput")+new Date().getTime();var t=u+"_Box";this.tagInputDivBox=f.create("div",{id:t,className:"muiTagAddInputBox"},this.tagInputBox,"first");var s=q("div",{id:u,dojoType:"mui/form/Input",className:"muiInput muiTagAddInput",dojoProps:{name:"sysTagMainForm.tagInpNames",showStatus:"edit",subject:p["mui.sysTagMain.tags"],validate:"maxLength(200)",placeholder:p["mui.sysTagMain.tags.placeholder"]}});s=f.toDom(s);f.place(s,this.tagInputDivBox);b.parse({rootNode:n.byId(t)});this.tagInputNode=g.byId(u)},addInputValidation:function(){var s=p["mui.sysTagMain.tags.prompt.error"];this.tagInputNode.validation.addValidator("checkTags",s,r.hitch(this,"doTagValidate"))},doTagValidate:function(){console.log("假装效验了");return true},buildSelectBtn:function(){var v=this.required=="true"?true:false;var t=this.isMul=="true"?true:false;var s=this.showTagInfo=="true"?true:false;var u=q("div",{id:this.getNodeIdStr("tag_SelectDialog"),dojoType:"sys/tag/mobile/import/js/select/SelectDialog",className:"muiCategoryAdd fontmuis muis-new muiNewAdd tag_SelectDialog",dojoProps:{title:p["mui.sysTagMain.tags.select"],idField:"sysTagMainForm.fdTagIds",nameField:"sysTagMainForm.fdTagNames",isMul:t,optClass:"mui-sys-tag-forward",align:"left",primaryKey:"curNames",showTagInfo:s,curIds:this.curIds,curNames:this.curNames,modelName:this.modelName,modelId:this.modelId,queryCondition:this.queryCondition,required:v,subject:p["mui.sysTagMain.tags"],showStatus:"edit",listDataUrl:"/sys/tag/sys_tag_tags/sysTagTags.do?method=getTagsDialogData&kind=list&parentId=!{parentId}",searchDataUrl:"/sys/tag/sys_tag_tags/sysTagTags.do?method=getTagsDialogData&kind=search&keyWord=!{keyword}"}});this.selectBtn=f.toDom(u);f.place(this.selectBtn,this.tagBoxNode,"last");b.parse({rootNode:n.byId("muiTagBox")})},getNodeIdStr:function(s){return s+"_"+this.fdKey},startup:function(){this.inherited(arguments)}})})},"sys/tag/mobile/import/js/select/DialogList":function(){define(["dojo/_base/declare","dojo/topic","dojo/dom-construct","dojo/_base/array","dojo/_base/lang","mui/util","mui/list/HashJsonStoreList","dojo/request","dojo/dom-style","dijit/registry","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/query","./tagUtil","mui/i18n/_i18n!kms/multidoc/mobile/mui-multidoc-view"],function(f,g,c,l,b,h,m,e,j,a,d,o,p,n,k,i){return f("mui.category.CategoryList",[m],{dataUrl:"",parentId:null,selType:null,curIds:null,curNames:null,isMul:false,baseClass:"muiCateLists",key:null,showMore:true,exceptValue:"",fieldParam:null,isSearched:false,rowsize:5,modelName:"",modelId:"",tagsRecord:"",queryCondition:"",TAG_CATEGORY_CHANGE_KEY:"/mui/tag/category/changed",TAG_BUILD_RECORD_KEY:"/mui/tag/build/record",TAG_EVENT_ADD_VALUE:"/mui/tag/addValue",buildRendering:function(){this.curNames=k.decodeHTML(this.curNames);this.url=h.urlResolver(this.dataUrl,this);this.inherited(arguments);this.domNode.className=this.baseClass},postCreate:function(){this.inherited(arguments);this.subscribe("/mui/category/changed","_cateChange");this.subscribe("/mui/search/cancel/back","_cateReback");this.subscribe("/mui/category/selected","_cateSelected");this.subscribe("/mui/cate/navTo","_scrollToCate");this.subscribe("/mui/category/selChanged","_setCurSel");this.subscribe("/mui/view/afterScroll","_setNavInfo");this.subscribe("/mui/search/submit","dataFresh");this.subscribe(this.TAG_CATEGORY_CHANGE_KEY,"dataFresh");this.subscribe("/mui/search/cancel","dataReset")},dataReset:function(t,s){if(this.isSearched){this.isSearched=false;var r=window.TAG_CATEGORY_LEVEL;var q=window.TAG_CATEGORY_VALUE[r];g.publish("/mui/category/changed",this,q)}},dataFresh:function(s,r){var q=null;if(r.keyword){this.isSearched=true;q={url:r.url}}if(r.fdId&&r.label){q={fdId:r.fdId,label:r.label}}if(q){g.publish("/mui/category/changed",this,q)}},resolveItems:function(q){this._loadOver=false;var r={};if(q){if(q.datas){this.listDatas=q.datas;r=q.page;if(r){this.pageno=parseInt(r.currentPage,10)+1;this.rowsize=parseInt(r.pageSize,10);this.totalSize=parseInt(r.totalSize,10);if(parseInt(r.totalSize||0,10)<=(this.pageno-1)*this.rowsize){this._loadOver=true}}}else{this.listDatas=q;this.totalSize=q.length;this.pageno=1;this._loadOver=true}}if(this._loadOver){g.publish("/mui/list/pushDomHide",this)}else{g.publish("/mui/list/pushDomShow",this)}return this.listDatas},resizeTagsRecord:function(){if(!this.tagsRecordBox){return}var s=this.getParent();if(!s){return}var q=s.domNode.offsetHeight;if(q<189&&s.containerNode){q=j.get(s.containerNode.parentElement,"height");if(q<189){q=j.get(s.containerNode.parentElement.parentElement,"height")}}var t=window.globalThis.innerHeight||window.document.documentElement.clientHeight;q=q<=0||t<=q?189:q;var r=q-64;r=r<189?189:r;j.set(this.tagsRecordBox,{height:r-64+"px"})},buildNoDataItem:function(q){this.inherited(arguments)},buildTagsRecord:function(){if(!this.tagsRecord){return}this.tagsRecordBox=c.create("div",{className:"muiTagsRecordBox"},this.domNode,"first");var q=i["mui.sysTagMain.tags.prompt.nodata"];if(window.TAG_CATEGORY_LEVEL==0){q=i["mui.sysTagMain.tags.category.select"]}c.create("div",{className:"muiTagsRecordPrompt",innerHTML:q},this.tagsRecordBox);if(this.tagsRecord.hotTags&&this.tagsRecord.hotTags.length>0){var v=this.tagsRecord.hotTags;var t=c.create("div",{className:"muiTagsHotRecord muiTagsDiv"},this.tagsRecordBox);c.create("div",{className:"muiTagsHotRecordTitle",innerHTML:i["mui.sysTagMain.tags.hot"]+"："},t);var u=c.create("div",{className:"muiTagsHotRecordContent"},t);for(var s=0;s<v.length;s++){var y=v[s];var x=c.create("div",{className:"muiTagsRecordItem","data-name":y,innerHTML:h.formatText(y)},u);this.connect(x,"click",b.hitch(this,function(B){var A=B.target;var z=o.get(A,"data-name");g.publish(this.TAG_EVENT_ADD_VALUE,this,{curIds:k.GenerateId(),curNames:z});g.publish("/mui/category/cancel",this)}))}}if(this.tagsRecord.usedTags&&this.tagsRecord.usedTags.length>0){var w=this.tagsRecord.usedTags;var r=c.create("div",{className:"muiTagsUsedRecord muiTagsDiv"},this.tagsRecordBox);c.create("div",{className:"muiTagsUsedRecordTitle",innerHTML:i["mui.sysTagMain.tags.used"]+"："},r);var u=c.create("div",{className:"muiTagsUsedRecordContent"},r);for(var s=0;s<w.length;s++){var y=w[s];var x=c.create("div",{className:"muiTagsRecordItem","data-name":y,innerHTML:h.formatText(y)},u);this.connect(x,"click",b.hitch(this,function(B){var A=B.target;var z=o.get(A,"data-name");g.publish(this.TAG_EVENT_ADD_VALUE,this,{curIds:k.GenerateId(),curNames:z});g.publish("/mui/category/cancel",this)}))}}},getTagsRecordData:function(){var q="/sys/tag/sys_tag_tags/sysTagTags.do?method=getTagsDialogData";q=h.formatUrl(q);var r=e.post(q,{handleAs:"json",data:{kind:"msg",queryCondition:this.queryCondition,modelName:this.modelName}});var s=this;r.then(function(t){s.tagsRecord=t})},buildQuery:function(){var y=this.inherited(arguments);var s={exceptValue:this.exceptValue};if(this.fieldParam!=null&&this.fieldParam!=""){var t=this.fieldParam.split(",");for(var u=0;u<t.length;u++){var r=t[u].indexOf(":");if(r>0){var v=document.getElementsByName(t[u].substring(r+1));if(v.length>0){var w="";if(v[0].type=="radio"||v[0].type=="checkbox"){for(var q=0;q<v.length;q++){if(v[q].checked){w+=(""==w?"":";")+v[q].value}}}else{if(v[0].tagName=="SELECT"){for(var q=0;q<v[0].options.length;q++){if(v[0].options[q].selected){w=v[0].options[q].value}}}else{w=v[0].value}}if(w!=""){s[t[u].substring(0,r)]=w}}}}}return b.mixin(y,s)},reload:function(){this.buildLoading();this.inherited(arguments)},startup:function(){this.inherited(arguments)},buildLoading:function(){if(this.tmpLoading==null){l.forEach(this.getChildren(),function(q){q.destroyRecursive()});this.tmpLoading=c.create("li",{className:"muiCateLoading",innerHTML:'<i class="mui mui-loading mui-spin"></i>'},this.domNode,"first")}},onComplete:function(){if(this.tmpLoading){c.destroy(this.tmpLoading);this.tmpLoading=null}this.inherited(arguments)},_setCurSel:function(r,q){if(r.key==this.key){if(q){this.curIds=q.curIds;this.curNames=q.curNames}}},_setNavInfo:function(r,q){if(r.key==this.key){var t=this.getChildren();var u=null;if(q.to.y<0){var v=false;for(var s=0;s<t.length;s++){if(t[s].header=="true"&&0-q.to.y>t[s].domNode.offsetTop-t[s].domNode.offsetHeight){g.publish("/mui/category/navChange",this,{label:t[s].getTitle()});v=true}}if(!v){g.publish("/mui/category/navChange",this,null)}}else{g.publish("/mui/category/navChange",this,null)}}},_scrollToCate:function(r,q){if(r.key==this.key){if(q){var t=this.getChildren();var u=null;for(var s=0;s<t.length;s++){if(t[s].header=="true"&&t[s].label==q.label){u=t[s];break}}if(u){g.publish("/mui/view/scrollTo",this,{y:0-u.domNode.offsetTop})}}}},_cateReback:function(r,q){if(r.key==this.key){if(this._addressUrl){this.url=this._addressUrl}g.publish("/mui/category/clearNav",this);this.showMore=true;this.buildLoading();this.reload()}},_cateChange:function(r,q){if(r.key==this.key){if(q&&q.url){if(!this._addressUrl){this._addressUrl=this.url}this.showMore=false;this.url=q.url}else{this.showMore=true;var s="";if(q&&q.fdId){s=q.fdId}this.parentId=s;this.url=h.urlResolver(h.formatUrl(this.dataUrl),this)}g.publish("/mui/category/clearNav",this);this.buildLoading();this.reload()}},_cateSelected:function(r,q){if(r.key==this.key){if(!this.isMul){this.curIds=q.fdId;this.curNames=q.label;g.publish("/mui/category/clearSelected",this,{fdId:q.fdId});if(!this.confirm){g.publish("/mui/category/submit",this,{key:this.key,curIds:q.fdId,curNames:q.label})}}}}})})},"sys/tag/mobile/import/js/list/sysTagListMixin":function(){define(["dojo/_base/declare","mui/list/_TemplateItemListMixin","sys/tag/mobile/import/js/item/sysTagItemMixin","dojo/_base/lang","dojo/query","dojo/topic","mui/util"],function(d,e,b,g,f,c,a){return d("hr.staff.mobile.resource.js.HrStaffTagItemMixin",[e],{itemRenderer:b,selectValue:[],formatDatas:function(h){var l=[];for(var n=0;n<h.length;n++){var m=h[n];l[n]={};for(var k=0;k<m.length;k++){l[n][m[k].col]=m[k].value;if(m[k].col=="index"){l[n][m[k].col]=n}}}return l},startup:function(){this.inherited(arguments);var h=this;c.subscribe("hr/staff/tag/list/value",function(i){if(i.value){h.selectValue[i.index]=i}else{h.selectValue[i.index]=""}c.publish("hr/staff/tag/selectvalue",h.selectValue)})}})})},"sys/tag/mobile/import/js/item/sysTagItemMixin":function(){define(["dojo/_base/declare","dojo/_base/array","dojo/dom-construct","dojo/dom-class","dojo/dom-style","dojo/dom-attr","dojox/mobile/_ItemBase","mui/list/item/_ListLinkItemMixin","dojo/on","dojo/topic"],function(b,f,a,i,d,g,j,h,e,c){var k=b("hr.staff.mobile.resource.js.item.HrStaffTagItemMixin",[j],{buildRendering:function(){this.inherited(arguments);this.renderTagItem()},startup:function(){this.inherited(arguments)},renderTagItem:function(){var m=false;var r=a.create("div",{className:"all-tag-item"},this.domNode);var l=a.create("div",{classNmae:"all-tag-checkbox"},r);var n=a.create("input",{classNmae:"",type:"checkbox",checked:m?"checked":false},l);var o=a.create("div",{className:"all-tag-name",innerHTML:"<span>名称:</span><span>"+this.fdName+"</span>"},r);var p=a.create("div",{className:"all-tag-category",innerHTML:"<span>分类:</span><span>"+this.fdCategorys+"</span>"},r);var q=this;e(n,"change",function(s){if(s.target.checked){c.publish("hr/staff/tag/list/value",{index:q.index,value:q.fdName,id:q.fdId,select:true})}else{c.publish("hr/staff/tag/list/value",{index:q.index,select:false})}})},_setLabelAttr:function(l){if(l){this._set("label",l)}}});return k})},"sys/bookmark/mobile/import/js/_BookTabBarButtonMixin":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/request","mui/util","dojo/dom-class","mui/dialog/Tip","mui/i18n/_i18n!kms/multidoc/mobile/mui-multidoc-view"],function(c,g,f,a,e,b,d){return c("mui.tabbar._BookTabBarButtonMixin",null,{isBookedUrl:"/sys/bookmark/sys_bookmark_main/sysBookmarkMain.do?method=isBooked",addBookedUrl:"/sys/bookmark/sys_bookmark_main/sysBookmarkMain.do?method=save&forward=lui-source",delBookedUrl:"/sys/bookmark/sys_bookmark_main/sysBookmarkMain.do?method=deleteBookmark",isBooked:false,sourceSubject:null,subject:null,url:null,modelId:null,modelName:null,lock:true,fdId:null,scaleClass:"muiBookMaskScale",bookedClass:"mui-star-on",unBookedClass:"mui-star-off",buildRendering:function(){this.inherited(arguments)},_setSubjectAttr:function(h){this.subject=this.getBookmarkSubject(h)},startup:function(){if(this._started){return}this.sourceSubject=this.subject;this.inherited(arguments);this.url=this.getBookmarkUrl();f(a.formatUrl(this.isBookedUrl),{handleAs:"json",method:"post",data:{url:this.url,fdId:this.modelId,fdModelName:this.modelName}}).then(g.hitch(this,function(h){if(h&&h.isBooked){this.toggleBooked(h)}this.set("lock",false)}))},replaceClass:function(i){var l=this["iconNode"+1],k=this["iconNode"+2];var j=i?this.bookedClass:this.unBookedClass,h=i?this.unBookedClass:this.bookedClass;e.replace(l,j+" "+this.scaleClass,h+" "+this.scaleClass);e.replace(k,j+" "+this.scaleClass,h+" "+this.scaleClass)},replaceLabel:function(h){if(h){this.labelNode.innerHTML=d["sysBookmark.mechanism.cancel"]}else{this.labelNode.innerHTML=d["sysBookmark.mechanism.bookMark"]}},removeScaleClass:function(){var i=this["iconNode"+1],h=this["iconNode"+2];this.defer(g.hitch(this,function(){e.remove(i,this.scaleClass);e.remove(h,this.scaleClass)}),300)},toggleBooked:function(h){if(h.isBooked){this.set("fdId",h.fdId)}else{this.set("isBooked",false)}if(this.icon1){this.replaceClass(h.isBooked);this.removeScaleClass()}if(this.label){this.replaceLabel(h.isBooked)}this.set("isBooked",h.isBooked);this.set("lock",false)},rq:function(i,j,h,k){f(a.formatUrl(i),{handleAs:h,method:"post",data:j}).then(g.hitch(this,k))},onClick:function(h){return this.doMark(h)},doMark:function(i,l){this.subject=this.getBookmarkSubject("");if(this.lock){return false}this.set("lock",true);var h=null,j=null;var k=d["sysBookmark.mechanism.add"];if(i){h=i.curIds;j=i.curNames;k=d["sysBookmark.mechanism.add.success"]}if(!this.isBooked){this.rq(this.addBookedUrl,{docSubject:this.subject,fdModelId:this.modelId,fdUrl:this.url,fdModelName:this.modelName,docCategoryId:h||"",docCategoryName:j||""},"json",function(m){this.toggleBooked({isBooked:true,fdId:m.fdId});b.tip({icon:"mui "+this.bookedClass,text:k,time:1000,callback:l||null})})}else{this.rq(this.delBookedUrl,{bookmarkId:this.fdId},"json",function(m){this.toggleBooked({isBooked:false});b.tip({icon:"mui "+this.unBookedClass,text:d["sysBookmark.mechanism.cancel"],time:1000,callback:l||null})})}return false},getBookmarkSubject:function(h){if(h.length<1){if(!!this.sourceSubject){return this.sourceSubject}var i=document.getElementsByClassName("muiDocViewHeaderSubject");if(!i||i.length<1){i=document.getElementsByTagName("title")}if(i!=null&&i.length>0){h=i[0].text||i[0].textContent;if(h==null){h=""}else{h=h.replace(/(^\s*)|(\s*$)/g,"")}}}return h},clearParam:function(h,i){var j=new RegExp();j.compile("([\\?&]"+i+"=)[^&]*","i");if(j.test(h)){h=h.replace(j,"")}return h},getBookmarkUrl:function(){var i=dojoConfig.baseUrl.substring(0,dojoConfig.baseUrl.length-1);var h=window.location.href;h=h.substring(h.indexOf("//")+2,h.length);h=h.substring(h.indexOf("/"),h.length);if(i.length>1){h=h.substring(i.length,h.length)}if(h.indexOf("viewPattern=edition")>-1){h=h.replace("&viewPattern=edition","")}h=this.clearParam(h,"_mobile");h=this.clearParam(h,"_referer");h=this.clearParam(h,"_time");return h}})})},"sys/tag/mobile/import/js/select/DialogHeader":function(){define(["dojo/_base/declare","dijit/_WidgetBase","dojo/dom-construct","dojo/dom-style","dojo/request","dojo/topic","mui/util","mui/i18n/_i18n!sys/mobile/js/mui/mui-common"],function(e,c,b,i,d,g,h,a){var f=e("mui.category.CategoryHeader",[c],{key:null,_parentId:null,curId:null,curName:null,height:"inherit",title:a["mui.category.pselect"],baseClass:"muiCateHeader",detailUrl:null,buildRendering:function(){this.inherited(arguments);if(!this.title||this.title==""){this.title=a["mui.category.select"]}this.contentNode=b.create("div",{className:"muiCateHeaderContent"},this.domNode);if(this.scope=="22"||this.scope=="33"||this.scope=="44"){this.titleDom=b.create("div",{className:"muiCateHeaderTitle",innerHTML:this.title},this.contentNode)}else{this.returnDom=b.create("div",{className:"muiCateHeaderReturn"},this.contentNode);this.titleDom=b.create("div",{className:"muiCateHeaderTitle",innerHTML:this.curName},this.contentNode)}this.cancelNode=b.create("div",{className:"muiCateHeaderCancel",innerHTML:a["mui.category.button.cancel"]},this.contentNode)},postCreate:function(){this.inherited(arguments);this.subscribe("/mui/category/changed","_chgHeaderInfo");this.subscribe("/mui/search/submit","_hideHeader");this.subscribe("/mui/search/cancel","_showHeader");this.connect(this.returnDom,"click",function(){this.defer(function(){this._gotoParent()},350)});this.connect(this.cancelNode,"click",function(){this.defer(function(){this._goBack()},350)})},startup:function(){if(this._started){return}this.inherited(arguments);if(this.domNode.parentNode){var j;if(this.height==="inherit"){if(this.domNode.parentNode){j=this.domNode.parentNode.offsetHeight+"px"}}else{if(this.height){j=this.height}}i.set(this.domNode,{height:j,"line-height":j})}this._chgHeaderInfo(this,{fdId:this.curId});g.publish("/mui/category/changed",this,{fdId:this.curId})},_showHeader:function(j){if(j.key==this.key){i.set(this.domNode,{display:"block"})}},_hideHeader:function(j){if(j.key==this.key){i.set(this.domNode,{display:"none"})}},_refreshHeader:function(){this._buildReturn();if(this.scope=="22"||this.scope=="33"||this.scope=="44"){this.titleDom.innerHTML=this.title}else{this.titleDom.innerHTML=this.curName}},_buildReturn:function(){if(this.scope=="22"||this.scope=="33"||this.scope=="44"){}else{if(this.curId){if(!this.returnIcon){this.returnIcon=b.create("i",{className:"mui mui-back"},this.returnDom);this.returnText=b.create("span",{className:"muiCateHeaderReturnTxt",innerHTML:" "+a["mui.category.button.up"]},this.returnDom)}}else{b.empty(this.returnDom);this.returnIcon=null;this.returnText=null}}},_gotoParent:function(){var j={};var l=window.TAG_CATEGORY_VALUE;var k=window.TAG_CATEGORY_LEVEL;if(k==0||!k){return}k=--window.TAG_CATEGORY_LEVEL;if(l&&l[k]&&l[k].fdId){j.fdId=l[k].fdId;j.label=l[k].label}g.publish("/mui/category/changed",this,j)},_goBack:function(){g.publish("/mui/category/cancel",this)},resolveCateData:function(l){var j={fdId:[],label:[],parentId:[]};for(var k=0;k<l.length;k++){j.fdId[k]=l[k].fdId;j.label[k]=l[k].label;if(l[k].parentId){j.parentId[k]=l[k].parentId}}j.fdId=j.fdId.join(";");j.label=j.label.join(";");j.parentId=j.parentId.join(";");return j},_chgHeaderInfo:function(k,j){if(k.key==this.key){if(j){if(j.fdId&&this.titleDom){this.curId=j.fdId;this.curName=j.label;this._refreshHeader()}else{this.curId=null;this.curName=this.title;this._parentId=null;this._refreshHeader()}}}}});return f})},"sys/tag/mobile/import/js/select/DialogItemMixin":function(){define(["dojo/_base/declare","dojo/dom-class","dojo/dom-style","mui/iconUtils","./_DialoagItemMixinBase","mui/util","dijit/registry"],function(d,h,c,e,g,a,b){var f=d("mui.tag.DialogItemMixin",[g],{buildRendering:function(){this.fdId=this.value;this.label=this.text;this.icon="mui mui-organization";this.type=window.TAG_TYPE_DOCUMENT;this.inherited(arguments);if(this.name&&this.name!=""){this.titleNode.innerHTML=a.formatText(this.name)}},getTitle:function(){return this.label},showMore:function(){return false},showSelect:function(){var i=this.getParent();if(i&&this.type==window.TAG_TYPE_DOCUMENT){return true}return false},isSelected:function(){var l=this.getParent();var k=b.byId("tag_DialogItemListMixin");if(l&&l[l.primaryKey]){var i=l[l.primaryKey].split(";");var j="fdId";if(l.primaryKey=="curNames"){j="label"}if(i.indexOf(this[j])>-1){return true}}return false},buildIcon:function(i){if(this.icon){if(this.nodeType!="CATEGORY"){c.set(i,"display","none")}e.setIcon(this.icon,null,this._headerIcon,null,i)}}});return f})},"sys/tag/mobile/import/js/select/DialogSearchBar":function(){define(["dojo/_base/declare","mui/search/SearchBar","mui/i18n/_i18n!sys/mobile/js/mui/mui-common","mui/util","dojo/topic","dojo/dom","dojo/dom-style"],function(d,g,e,a,b,f,c){return d("mui.tag.DialogSearchBar",[g],{searchUrl:"",jumpToSearchUrl:false,keyword:"",exceptValue:"",placeHolder:e["mui.search.search"],needPrompt:false,orgType:null,_onSearch:function(i){this._eventStop(i);this.set("keyword",this.searchNode.value);if(this.keyword){var l={};if(!this.needPrompt){if(this.searchUrl){var k=this.searchUrl;k=a.urlResolver(k,this);var j=window.TAG_CATEGORY_VALUE;var h=window.TAG_CATEGORY_LEVEL;var m=j?(j[h]?j[h]:""):"";var o=m.fdId?m.fdId:"";if(o){k+="&parentId="+o}k=a.formatUrl(k);l.url=k}l.keyword=decodeURIComponent(this.keyword);l.modelName=this.modelName;l.searchFields=this.searchFields;l.docStatus=this.docStatus}var n=f.byId("tag_DialogCategorySelect");c.set(n,"display","none");c.set(this.domNode,"width","100%");b.publish("/mui/search/submit",this,l)}return false},_onCancel:function(){this.inherited(arguments)}})})},"sys/tag/mobile/import/js/select/DialogMixin":function(){define(["dojo/_base/declare","dojo/topic","dojo/dom","dojo/dom-construct","dojo/dom-style","dojo/dom-class","dojo/_base/lang","dojo/html","dojo/_base/array","mui/util","dojo/touch","./_DialogCategoryBase","./tagUtil"],function(g,j,e,d,k,n,c,i,m,h,f,a,l){window.TAG_TYPE_DOCUMENT=2;var b=g("mui.tag.DialogMixin",[a],{listDataUrl:"",detailUrl:"",searchDataUrl:"",fieldParam:"",isMul:false,templURL:"",title:"",primaryKey:"",modelName:"",modelId:"",queryCondition:"",fdKey:"",isClick:false,buildRendering:function(){this.inherited(arguments)},clearClick:function(){this.defer(function(){this.isClick=false},350)},_setIsMulAttr:function(o){this._set("isMul",o);if(o=="true"||o==true){this.templURL="sys/tag/mobile/import/js/tmpl/dialog_mul.jsp"}else{this.templURL="sys/tag/mobile/import/js/tmpl/dialog_sgl.jsp"}},_selectCate:function(){if(this.isClick){return}this.isClick=true;this.clearClick();this.inherited(arguments)},_selectCate$1:function(){var q;if(this.templURL){q=this.urlResolver(this.templURL);if(!q){return}q="dojo/text!"+q}else{if(this.jsURL){q=this.urlResolver(this.jsURL);if(!q){return}}}var o=this;var p=this._cateDialogPrefix+this.key;require([q],function(s){o.dialogDiv=d.create("div",{id:p,className:"muiCateDiaglogN",tabindex:"0"},document.body,"last");o.dialogContainerDiv=d.create("div",{className:"muiCateDiaglogContainer "},o.dialogDiv);o.dialogDiv.focus();o.defer(function(){o.connect(o.dialogDiv,"click","_closeDialog")},500);h.disableTouch(o.dialogDiv,f.move);var r=new i._ContentSetter({node:o.dialogContainerDiv,parseContent:true,cleanContent:true,onBegin:function(){o.curNames=l.encodeHTML(o.curNames);this.content=c.replace(this.content,{categroy:o});this.inherited("onBegin",arguments)}});r.set(s);r.parseDeferred.then(function(t){o.parseResults=t;j.publish("/mui/category/tmploaded",{dom:o.dialogDiv,widgetList:t})});r.tearDown();o.showAnimate()})}});return b})},"sys/tag/mobile/import/js/select/DialogSelection":function(){define(["dojo/_base/declare","dojo/_base/lang","dijit/_WidgetBase","dojo/_base/array","dojo/dom","dojo/dom-construct","dojo/request","dojo/topic","mui/util","mui/dialog/Dialog","mui/dialog/Tip","mui/iconUtils","mui/history/listener","mui/i18n/_i18n!sys/mobile/js/mui/mui-common","./tagUtil"],function(i,a,g,m,f,e,h,k,j,n,p,d,b,c,l){var o=i("mui.tag.CategorySelection",[g],{curIds:null,curNames:null,beforeSelectCateHistoryId:null,detailUrl:"",primaryKey:"curIds",isMul:true,baseClass:"muiCateSec muiCateSecBottom",cateSelArr:[],itemPrefix:"_CateSecItem_",key:null,buildRendering:function(){this.curNames=l.decodeHTML(this.curNames);this.inherited(arguments);this.cateSelArr=[];this.containerNode=e.create("div",{className:"muiCateSecContainer"},this.domNode);this.leftArea=e.create("div",{className:"muiCateSecLeft"},this.containerNode);this.rightArea=e.create("div",{className:"muiCateSecRight"},this.containerNode);this.clearButtonNode=e.create("span",{className:"muiCateClearBtn",innerHTML:c["mui.button.clear"]},this.rightArea);this.buttonNode=e.create("span",{className:"muiCateSecBtn ",innerHTML:c["mui.button.ok"]},this.rightArea)},postCreate:function(){this.inherited(arguments);this.subscribe("/mui/category/selected","_addSelItme");this.subscribe("/mui/category/unselected","_delSelItem");this.subscribe("/mui/category/clearSelected","_clearSelItem")},startup:function(){if(this._started){return}this.inherited(arguments);this._initSelection()},destroy:function(){this.inherited(arguments)},_subSelItem:function(){k.publish("/mui/category/submit",this,this._calcCurSel())},_clearSelItem:function(t,q){if(t.key!=this.key){return}var u;if(q){u=q.fdId}var r=0;while(this.cateSelArr.length>r){var s=this.cateSelArr[0];if(s.fdId==u){r++;continue}this._delSelItem(this,s);k.publish("/mui/category/cancelSelected",this,s)}},_popSelItem:function(){var s;var r;var u=a.hitch(this,function(){var v=e.create("div",{className:"muiCateSecItems"});m.forEach(this.cateSelArr,function(w){var x=this._buildSelItem(w);v.appendChild(x)},this);r=n.element({canClose:false,element:v,position:"bottom",scrollable:true,parseable:true,showClass:"muiTagCateSecPop",callback:a.hitch(this,function(){if(s){b.go({historyId:s,callback:function(){}})}r=null;s=null})})});var t=a.hitch(this,function(){if(r){r.hide();r=null;s=null}});var q=b.push({forwardCallback:u,backCallback:t});s=q.previousId},_initSelection:function(){var w=this;if(this[this.primaryKey]){if(this.detailUrl){var s=j.urlResolver(this.detailUrl,this);s=j.formatUrl(s);var B;if(s.length>2048&&s.indexOf(".jsp?")>-1){var r=s.split("?");var x=r[1].split("&");var z=[];var y={};for(var u=0;u<x.length;u++){if(x[u].length>0){var A=x[u].split("=");if(A[1].length>500){y[A[0]]=A[1]}else{z.push(x[u])}}}s=r[0]+"?"+z.join("&");B=h.post(s,{handleAs:"json",data:y})}else{B=h.post(s,{handleAs:"json"})}B.then(function(C){if(C.length>0){m.forEach(C,function(D){w._addSelItme(w,D)})}})}else{var q=this.curIds.split(";");var v=this.curNames.split(";");var t=[];m.forEach(v,function(D,E){var F=q[E]?q[E]:l.GenerateId();var C={fdId:F,label:D,labelLevel:D};t.push(C)});this.cateSelArr=t;this.defer(function(){this._resizeSelection()},250)}}else{this._resizeSelection()}},buildDesc:function(){},_buildSelItem:function(q){var t=e.create("div",{id:this.itemPrefix+q.fdId,className:"muiCateSecItem"});this.buildIcon(t,q);var r=e.create("div",{className:"muiCateSecItemLabel"},t);e.create("div",{innerHTML:q.label},r);this.buildDesc(r,q);var s=e.create("div",{className:"muiCateSecItemDelArea"},t);e.create("div",{className:"muiCateSecItemDel"},s);this.connect(s,"click",function(u){this._delSelItem(this,q);e.destroy(f.byId(this.itemPrefix+q.fdId));k.publish("/mui/category/cancelSelected",this,q)});return t},buildIcon:function(q,r){d.setIcon("mui mui-file-text",null,null,null,q)},_checkInSelArr:function(s){var q=false;for(var r=0;r<this.cateSelArr.length;r++){if(this.cateSelArr[r].fdId==s){q=true;break}}return q},_addSelItme:function(r,q){if(r.key==this.key){if(q){if(typeof q.labelLevel=="undefined"){q.labelLevel=typeof r.labelLevel!="undefined"?r.labelLevel:r.label}if(!this._checkInSelArr(q.fdId)){this.cateSelArr.push(q)}}this._resizeSelection()}},_delSelItem:function(r,q){if(r.key==this.key){if(q&&q.fdId){for(var s=0;s<this.cateSelArr.length;s++){if(this.cateSelArr[s].fdId==q.fdId){this.cateSelArr.splice(s,1);break}}this._resizeSelection()}}},_resizeSelection:function(){var r=0;var q=this.cateSelArr.length;if(this.subHandle==null){this.subHandle=this.connect(this.buttonNode,"click","_subSelItem")}if(q>0){this.leftArea.className="muiCateSecLeft";this.clearButtonNode.className="muiCateClearBtn";if(this.clearHandle==null){this.clearHandle=this.connect(this.clearButtonNode,"click",a.hitch(this,function(){this._clearSelItem(this);this.clearButtonNode.className="muiCateClearBtn muiCateSecBtnDis";if(this.clearHandle){this.disconnect(this.clearHandle);this.clearHandle=null}}))}if(this.popHandle==null){this.popHandle=this.connect(this.leftArea,"click","_popSelItem")}}else{this.leftArea.className="muiCateSecLeft muiCateSecBtnDis";this.clearButtonNode.className="muiCateClearBtn muiCateSecBtnDis";if(this.popHandle){this.disconnect(this.popHandle);this.popHandle=null}if(this.clearHandle){this.disconnect(this.clearHandle);this.clearHandle=null}}this.leftArea.innerHTML=c["mui.button.count"].replace("%count%",q)},_calcCurSel:function(){var q={curIds:"",curNames:"",key:this.key};if(this.cateSelArr.length>0){var r="";var s="";m.forEach(this.cateSelArr,function(t){r+=";"+t.fdId;s+=";"+t.label});if(r!=""){r=r.substring(1);s=s.substring(1);q.curIds=r;q.curNames=s}}if(q.curNames==""){q.curNames=window.SEL_CATEGORY_DEFAULT_TITLE}return q}});return o})},"sys/tag/mobile/import/js/select/_DialoagItemMixinBase":function(){define(["dojo/_base/declare","dojo/dom-construct","dojo/dom-class","dojo/topic","dojox/mobile/_ItemBase","mui/util","mui/history/listener","mui/iconUtils","mui/i18n/_i18n!kms/multidoc/mobile/mui-multidoc-view","dijit/registry"],function(e,d,i,f,j,g,b,c,h,a){var k=e("mui.category.CategoryItemMixin",[j],{fdId:"",label:"",icon:"",type:null,header:"false",tag:"li",key:null,buildRendering:function(){this._templated=!!this.templateString;var m=this.domNode==null&&this.containerNode==null&&this.srcNodeRef==null;if(!this._templated&&m){this.domNode=this.containerNode=this.srcNodeRef||d.create(this.tag,{className:"muiCateItem fadeIn animated"});var l="muiCateInfoItem";if(this.header=="true"){l=" muiGroupItem"}this.contentNode=d.create("div",{className:l},this.domNode)}this.parentNode=a.byId("tag_DialogItemListMixin");if(this.parentNode&&this.parentNode.showTagInfo){this.showTagInfo=this.parentNode.showTagInfo}this.inherited(arguments);if(!this._templated){this._buildItemBase()}},postCreate:function(){this.inherited(arguments);this.subscribe("/mui/category/cancelSelected","_cancelSelected");this.subscribe("/mui/category/setSelected","_setSelected");this.subscribe("/mui/category/commonSelected","commonSelected");this.subscribe("/mui/category/commonUnSelected","commonUnSelected")},_buildItemBase:function(){this.cateContainer=d.create("div",{className:"muiCateContainer"},this.contentNode);if(this.type!=0){this.iconNode=d.create("div",{className:"muiCateIcon"},this.cateContainer);this.buildIcon(this.iconNode);if(this.fdIsAvailable===false){this.availableNode=d.create("div",{className:"muiAddressIsAvailableFalse"},this.iconNode)}this.infoNode=d.create("div",{className:"muiCateInfo"},this.cateContainer);this.titleNode=d.create("div",{className:"muiCateName",innerHTML:g.formatText(this.label)},this.infoNode);if(this.showTagInfo){this.cateBoxNode=d.create("div",{className:"muiCateBox"},this.infoNode);this.cateMsgRightNode=d.create("div",{className:"muiCateMsgCite",innerHTML:"<span>"+h["mui.sysTagMain.tags.fdQuoteTimes"]+"：</span><span>"+this.quoteNum+"</span>"},this.cateBoxNode);this.cateMsgLeftNode=d.create("div",{className:"muiCateMsgClassify",innerHTML:"<span>"+h["mui.sysTagMain.tags.category"]+"：</span><span>"+g.formatText(this.cateName)+"</span>"},this.cateBoxNode)}this.connect(this.iconNode,"click","_selectCate");this.connect(this.infoNode,"click","_selectCate")}this.moreArea=d.create("div",{className:"muiCateMore"},this.cateContainer)},startup:function(){if(this._started){return}this.inherited(arguments);var l=this.getParent();this.key=l.key;if(this.type!=0){if(l.showMore&&this.showMore()){if(this.moreArea.childElementCount==0){d.create("i",{className:"mui mui-forward"},this.moreArea)}this.connect(this.moreArea,"click","_openCate")}else{d.destroy(this.moreArea)}if(l.selType!=null){if(this.showSelect()){this.selectArea=d.create("div",{className:"muiCateSelArea"},this.cateContainer,"first");this.selectNode=d.create("div",{className:"muiCateSel"},this.selectArea);var m=this.getParent();if(m.isMul){i.add(this.selectNode,"muiCateSelMul")}if(this.isSelected()){this.checkedIcon=d.create("i",{className:"mui mui-checked muiCateSelected"},this.selectNode);i.add(this.selectNode,"muiCateSeled")}i.add(this.domNode,"muiCateHasSel");this.connect(this.selectArea,"click","_selectCate")}}}else{f.publish("/mui/category/addNav",this,{label:this.label})}},_openCate:function(l){l&&l.stopPropagation();f.publish("/mui/category/changed",this,{fdId:this.fdId,label:this.label});return},_cancelSelectedTrigger:function(l){f.publish("/mui/category/unselected",this,{label:this.label,fdId:this.fdId,icon:this.icon,type:this.type});f.publish("/mui/category/cate_unselected",this,{label:this.label,fdId:this.fdId,icon:this.icon,type:this.type})},_cancelSelected:function(m,l){if(m.key==this.key){if(l&&l.fdId){if(l.fdId.indexOf(this.fdId)>-1){if(this.checkedIcon){i.remove(this.selectNode,"muiCateSeled");d.destroy(this.checkedIcon);this.checkedIcon=null;this._cancelSelectedTrigger(l)}}}}},commonUnSelected:function(m,l){if(m.key==this.key){if(l&&l.fdId){if(l.fdId.indexOf(this.fdId)>-1){if(this.checkedIcon){i.remove(this.selectNode,"muiCateSeled");d.destroy(this.checkedIcon);this.checkedIcon=null}}}}},commonSelected:function(m,l){if(m.key==this.key){if(l&&l.fdId){if(l.fdId==this.fdId){i.add(this.selectNode,"muiCateSeled");if(!this.checkedIcon){this.checkedIcon=d.create("i",{className:"mui mui-checked muiCateSelected"},this.selectNode)}}}}},_setSelectedTrigger:function(){f.publish("/mui/category/selected",this,{label:this.label,fdId:this.fdId,icon:this.icon,type:this.type});f.publish("/mui/category/cate_selected",this,{label:this.label,fdId:this.fdId,icon:this.icon,type:this.type})},_setSelected:function(m,l){if(m.key==this.key){if(l&&l.fdId){if(l.fdId==this.fdId){if(this.checkedIcon){d.destroy(this.checkedIcon);this.checkedIcon=null}if(!this.selectNode){return}if(!i.contains(this.selectNode,"muiCateSeled")){i.add(this.selectNode,"muiCateSeled")}this.checkedIcon=d.create("i",{className:"mui mui-checked muiCateSelected"},this.selectNode);this._setSelectedTrigger(l)}}}},startTime:0,_toggleSelect:function(l){if(l){this._setSelected(this,this)}else{this._cancelSelected(this,this)}var m=this.getParent()},_selectCate:function(l){if(l){if(l.stopPropagation){l.stopPropagation()}if(l.cancelBubble){l.cancelBubble=true}if(l.preventDefault){l.preventDefault()}if(l.returnValue){l.returnValue=false}}var n=new Date().getTime();var o=this.ctime;if((o!="undefined"&&(n-o<500))||this.selectCateCalling){return false}else{this.ctime=new Date().getTime();this.selectCateCalling=true;if(this.selectNode){if(this.checkedIcon!=null){this._toggleSelect(false)}else{this._toggleSelect(true)}}else{var m=this.getParent();if(this.showMore()&&m.showMore){this._openCate()}else{this.showItemDetail()}}this.ctime=new Date().getTime();this.selectCateCalling=false;return true}},getTitle:function(){return this.label},showMore:function(){return true},showSelect:function(){return true},isSelected:function(){return true},showItemDetail:function(){},buildIcon:function(l){if(this.icon){c.setIcon(this.icon,null,this._headerIcon,null,l)}},_setLabelAttr:function(l){if(l){this._set("label",l)}}});return k})},"sys/tag/mobile/import/js/select/DialogItemListMixin":function(){define(["dojo/_base/declare","mui/list/_TemplateItemListMixin","./DialogItemMixin","./tagUtil"],function(c,b,d,a){return c("mui.tag.DialogItemListMixin",[b],{itemRenderer:d,buildRendering:function(){this.curNames=a.decodeHTML(this.curNames);this.inherited(arguments)}})})},"sys/tag/mobile/import/js/select/DialogTagScrollViewMixin":function(){define(["dojo/_base/declare","dojo/dom-geometry","dojo/dom","dojo/dom-style"],function(b,d,c,a){return b("mui.tag.DialogTagScrollViewMixin",[],{isMul:true,resize:function(){this.inherited(arguments);this._appFooterHeight=(this._fixedAppFooter)?this._fixedAppFooter.offsetHeight:0;var i=this.domNode.getBoundingClientRect().top;var f,j=this.getScreenSize().h,g=j-i-this._appFooterHeight;if(this.height){f=this.height}if(!f){f=g+"px"}if(f.charAt(0)!=="-"&&f!=="default"){var e=f.substring(0,f.length-2);if(this.isMul){e=Number(e)-64}this.domNode.style.height=e+"px"}}})})},"sys/tag/mobile/import/js/select/_DialogCategoryBase":function(){define(["dojo/_base/declare","mui/form/_CategoryBase","dojo/dom","dojo/dom-construct","dojo/dom-style","dojo/dom-class","dojo/_base/lang","dojo/_base/array","mui/device/adapter","mui/history/listener"],function(g,a,f,e,h,k,b,i,j,c){var d=g("mui.tag.DialogCategoryBase",a,{listDataUrl:"",selectionUrl:"",searchDataUrl:"",fieldParam:"",__doCloseDialog:function(){if(this.previousTitle){j.setTitle(this.previousTitle);this.previousTitle=null}if(this.beforeSelectCateHistoryId){c.goNoop({historyId:this.beforeSelectCateHistoryId});this.beforeSelectCateHistoryId=null}if(this.dialogDiv){k.add(this.dialogDiv,"fadeOut animated")}this.defer(function(){if(this.dialogContainerDiv){h.set(this.dialogContainerDiv,"display","none")}if(this.dialogDiv){h.set(this.dialogDiv,"display","none")}},500);setTimeout(b.hitch(this,function(){if(this.parseResults&&this.parseResults.length){i.forEach(this.parseResults,function(l){if(l.destroy){l.destroy()}});delete this.parseResults}e.destroy(this.dialogDiv);this.dialogDiv=null;this._working=false}),410)},showAnimate:function(){h.set(this.dialogContainerDiv,"display","block");if(this.dialogDiv){h.set(this.dialogDiv,"display","block");k.add(this.dialogDiv,"fadeIn animated");h.set(this.dialogDiv,"background-color","rgba(0, 0, 0, 0.6)");this.defer(function(){if(this.dialogDiv){h.set(this.dialogDiv,{opacity:1});k.remove(this.dialogDiv,"fadeIn")}},500)}}});return d})},"sys/bookmark/mobile/import/js/_BookMarkCategoryMixin":function(){define(["dojo/_base/declare","mui/form/_CategoryBase","mui/simplecategory/SimpleCategoryMixin","dojox/mobile/sniff","mui/i18n/_i18n!kms/multidoc/mobile/mui-multidoc-view"],function(c,a,e,b,d){return c("sys.bookmark._BookMarkCategoryMixin",[a,e],{buildRendering:function(){this.required=true;this.modelName="com.landray.kmss.sys.bookmark.model.SysBookmarkCategory";this.key="sysBookmarkCategory";this.inherited(arguments);this.domNode.dojoClick=!b("ios")},postCreate:function(){this.inherited(arguments);this.eventBind()},onClick:function(f){if(!this.isBooked){this.subject=d["mui.sysBookmark.select"];this._selectCate()}else{this.doMark(f)}return false},returnDialog:function(h,g){var f=this;if(g){if(h.key==this.key){this.curIds=g.curIds;this.curNames=g.curNames;this.doMark(g,function(){f.defer(function(){f.closeDialog(h);f.curIds="";f.curNames=""},300)})}}}})})},"sys/tag/mobile/import/js/select/SelectDialog":function(){define(["dojo/_base/declare","./DialogCategory","./DialogMixin"],function(a,c,b){return a("mui.tag.SelectDialog",[c,b],{exceptValue:"",required:"",cateFieldShow:".muiTagInputBox",primaryKey:"curIds"})})},"sys/tag/mobile/import/js/select/tagUtil":function(){define(["dojo/_base/declare"],function(b){var a=b("tag.util",null,{encodeHTML:function(c){if(c==null||c.length==0){return""}return c.replace(/&/g,"{#amp}").replace(/</g,"{#lt}").replace(/>/g,"{#gt}").replace(/\'/g,"{#apos}").replace(/\"/g,"{#quot}").replace(/\\/g,"{#slash}")},decodeHTML:function(c){if(c==null||c.length==0){return""}return(c+"").replace(/{#amp}/g,"&").replace(/{#lt}/g,"<").replace(/{#gt}/g,">").replace(/{#apos}/g,"'").replace(/{#quot}/g,'"').replace(/{#slash}/g,"\\")},GenerateId:function(){return String(new Date().getTime())}});return new a()})},"sys/tag/mobile/import/js/select/DialogCategoryBar":function(){define(["dojo/_base/declare","dijit/_WidgetBase","./DialogSelCategory","dojo/dom-construct","dojo/_base/lang","dojo/topic","dojo/_base/array","mui/createUtils","dojo/parser","dojo/dom","dijit/registry","dojo/dom-style","mui/i18n/_i18n!kms/multidoc/mobile/mui-multidoc-view"],function(g,j,b,e,d,h,l,m,c,f,a,k,i){var n=m.createTemplate;var o=g("mui.tag.DialogSelCategory",[j],{SELECT_CALLBACK:"mui/form/select/callback",LIST_LOADED_KEY:"/mui/list/loaded",CATEGORY_CHANGE_KEY:"/mui/category/changed",TAG_CATEGORY_CHANGE_KEY:"/mui/tag/category/changed",option:[],parentIndex:"",isSleep:false,startup:function(){this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);window.TAG_CATEGORY_LEVEL=0;window.TAG_CATEGORY_VALUE=[];this.subscribe(this.SELECT_CALLBACK,function(p){if(!this.isSleep){window.TAG_CATEGORY_LEVEL++;this.isSleep=true;var r={fdId:p.value,label:p.text};var q=window.TAG_CATEGORY_LEVEL;window.TAG_CATEGORY_VALUE[q]=r;h.publish(this.TAG_CATEGORY_CHANGE_KEY,this,r);this.defer(function(){this.isSleep=false},350)}});this.subscribe(this.LIST_LOADED_KEY,"buildSelect");this.buildSelect()},buildSelect:function(t,q){var s=[];var u=f.byId("tag_DialogSearchBar");if(q&&q.categorys){s=q.categorys;this.select.destroy()}if(u){if(s.length>0){k.set(this.domNode,"display","inline-block");k.set(u,"width","50%")}else{k.set(this.domNode,"display","none");k.set(u,"width","100%")}}this.option=s;var p=n("div",{id:"muiTagDialogTagSelect",className:"muiDialogTagSelect",dojoType:"sys/tag/mobile/import/js/select/DialogSelCategory",dojoProps:{store:this.option,mul:true,showPleaseSelect:true,subject:i["mui.sysTagMain.tags.category.subject"]}});var r=e.toDom(p);e.place(r,this.domNode);c.parse({rootNode:f.byId("tag_DialogCategorySelect")});this.select=a.byId("muiTagDialogTagSelect")}});return o})},"sys/tag/mobile/import/js/select/CategoryDialog":function(){define(["dojo/_base/declare","mui/dialog/Dialog","dojo/dom-construct"],function(d,b,a){var c=d("sys.tag.CategoryDialog",[b.claz],{buildRendering:function(){this.inherited(arguments);this.canenlBoxNode=a.create("div",{className:"muiTagDialogContainer"},this.containerNode);this.cancelBtn=a.create("div",{className:"muiTagDialogBottom",innerHTML:"取消"},this.canenlBoxNode);this.connect(this.cancelBtn,"click","_onClose")},_onClose:function(e){if(this.callback){this.callback(window,this)}this.hide()}});return{element:function(e){var f=new c(e);return f.show()}}})}}});require({cache:{"kms/multidoc/mobile/mui-multidoc-view_zh-cn._min_":function(){define("",{"mui.sysTagMain.tags.select":"选择标签","mui.sysTagMain.tags.category.subject":"标签分类","mui.sysTagMain.tags.placeholder":"请输入标签,多标签用(;)隔开","mui.sysTagMain.tags.category":"分类","mui.sysTagMain.tags.category.select":"请选择分类","mui.sysTagMain.tags.prompt.nodata":"暂无数据","mui.sysTagMain.tags":"标签","mui.sysTagMain.tags.fdQuoteTimes":"引用次数","mui.sysTagMain.tags.used":"使用过的标签","mui.sysTagMain.tags.hot":"热门标签","mui.sysTagMain.tags.prompt.error":"标签输入不正确","sysBookmark.mechanism.add.success":"收藏成功","sysBookmark.mechanism.label.name":"名称","sysBookmark.mechanism.dialog.title":"收藏夹分类设置","sysBookmark.mechanism.add":"添加收藏","sysBookmark.mechanism.opt.delSuccess":"取消收藏成功","sysBookmark.mechanism.create.link":"新建链接","sysBookmark.mechanism.bookMark":"收藏","sysBookmark.mechanism.create.pos":"创建位置","sysBookmark.mechanism.summary":'将该知识加入收藏。查看我的<a data-type="bookmark">收藏夹&gt;&gt;</a>',"sysBookmark.mechanism.button.ok":"确定","sysBookmark.mechanism.button.cancel":"取消","sysBookmark.mechanism.cancel":"取消收藏","sysBookmark.mechanism.prompt":"请选择收藏分类","sysBookmark.mechanism.opt.sucess":"操作成功","sysBookmark.mechanism.illegal":"链接包含非法字符，禁止打开！","sysBookmark.mechanism.opt.fail":"操作失败","sysBookmark.mechanism.exsit":"已经收藏过此文档","sysBookmark.mechanism.create.cate":"新建分类","mui.sysBookmark.select":"选择收藏夹"})}}});